# 1. 모놀리식 지옥에서 벗어나라

# 서서히 모놀리식 지옥에 빠져들다

## FTGO 애플리케이션 아키텍처

- FTGO(Food to Go)의 예시
  - 육각형 아키텍처를 가진 FTGO 애플리케이션은 모바일 앱과 클라우드 서비스 같은 외부 시스템과의 인터페이스와 UI가 구현된 어댑터로 둘러싸인 비즈니스 로직으로 구성된다. (30p의 그림 1-1)
- 논리적으로 모듈화한 아키텍처임에도 애플리케이션은 WAR 파일 하나로 패키징한다.

## 모놀리식 아키텍처의 장점

- 개발이 간단하다.
- 애플리케이션을 쉽게 변경할 수 있다.
- 테스트하기 쉽다.
- 배포하기 쉽다.
- 확장하기 쉽다.

## 모놀리식 지옥의 실상

- 개발 팀이 스프린트를 할 때마다 추가 구현할 스토리가 늘어났고 그만큼 코드베이스와 관리 오버헤드 역시 증가
- 너무 복잡해서 개발자가 주눅 들다
  - IDE를 실행하니 마주하는 수백개의 파일들 . . .? OMG
- 개발이 더디다.
  - IDE indexing 하는데 5만년
  - 빌드 또한... ([https://gradle.org/maven-vs-gradle/](https://gradle.org/maven-vs-gradle/))
- 커밋부터 배포에 이르는 길고 험난한 여정
  - 주륵...
- 확장하기 어렵다.
  - 확장 하면 애플리케이션의 모든 부분이 같이 확장됨
- 모놀리스는 확실하게 전달하기 어렵다.
- 갈수록 한물간 기술 스택에 발목이 붙잡힌다.

# 이 책의 학습 내용

- 마이크로서비스 아키텍처 패턴으로 애플리케이션을 아키텍처링
- 서비스 비즈니스 로직 개발
- 사가를 이용하여 서비스 간 데이터 일관성 유지
- 여러 서비스에 걸친 쿼리 구현
- 마이크로서비스를 효율적으로 테스트
- 안전하고, 구성 가능하고, 관측 가능한 프로덕션 레디 서비스를 개발

# 마이크로서비스 아키텍처기 답이다(?)

- FTGO 애플리케이션은 점점 몸집이 커지면서 여러가지 품질 속성이 악화되었고, 그중 소프트웨어 전달 속도( 확장성, 테스트성)가 가장 큰 영향을 받았다.
- 마이크로서비스란 무엇일까? 사람마다 의견이 천차만별이다.
  - 경계 컨텍스트가 있는, 느슨하게 결합된 엘리먼트로 구성된 서비스 지향 아키텍처

## 확장 큐브와 마이크로 서비스

- (38p 그림 1-3) 확장 큐브 모델 X, Y, Z 세 방향으로 확장 가능
- X축 확장: 다중 인스턴스에 고루 요청 분산
- Z축 확장: 요청 속성별 라우팅
- Y축 확장: 기능에 따라 애플리케이션을 서비스로 분해

## 마이크로서비스는 모듈성을 갖고 있다.

## 서비스마다 DB가 따로있다.

## FTGO 마이크로서비스 아키텍처

- (42p 그림 1-7) FTGO 마이크로 서비스 아키텍처 버전

## 마이크로서비스 아키텍처와 SOA

# 마이크로서비스 아키텍처의 장단점

## 마이크로서비스 아키텍처의 장점

- 크고 복잡한 애플리케이션을 지속적으로 전달/배포할 수 있습니다.
- 서비스 규모가 작아 관리하기 쉽습니다.
- 서비스를 독립적으로 배포/확장할 수 있습니다.
- 마이크로서비스 아키텍처 덕분에 팀이 자율적으로 움직입니다.
- 결함 격리가 잘됩니다.
- 새로운 기술을 실험하고 도입하기 쉽습니다.

## 마이크로서비스 아키텍처의 단점

- 딱 맞는 서비스를 찾기가 쉽지 않습니다.
- 분산 시스템은 너무 복잡해서 개발, 테스트, 배포가 어렵습니다.
- 여러 서비스에 걸친 기능을 배포할 때에는 잘 조정해야 합니다.
- 마이크로서비스 아키텍처 도입 시점을 결정하기가 어렵습니다.

# 마이크로서비스 아키텍처 패턴 언어

- 아키텍처와 설계는 전부 결정하기 나름이다.
- 모놀리식이 잘 맞을지 마이크로서비스가 잘 맞을지 결정하려면 수많은 트레이드오프를 검토하고, 그에 수반되는 갖가지 이슈도 해결해야 한다.

## 마이크로서비스 아키텍처도 만병통치약은 아니다.

## 패턴 및 패턴 언어

- 상용 패턴의 구조는 대략 다음 세 부분으로 구성된다.
  - 강제 조항
  - 결과 맥락
  - 연관 패턴
- 애플리케이션을 여러 서비스로 분해하는 패턴
  - 비지니스 능력에 따라
  - 하위 도메인에 따라
- 통신패턴
  - 통신 스타일
  - 디스커버리
  - 신뢰성
  - 트랜잭셔널 메시징
  - 외부 API
- 트랜잭션 관리를 위한 데이터 일관성 패턴
  - 사가 패턴
- 데이터 쿼리 패턴
- 서비스 배포 패턴
- etc ...

# 마이크로서비스 너머:프로세스와 조직

## 소프트웨어 개발/전달 조직

- 크기가 N인 팀의 소통 오버헤드는 O(N^2) !
- 거대한 한 팀보다는 작은 여러 팀의 움직임이 훨씬 빠르다.
- 각 팀마다 굳이 다른 팀과 협의할 필요 없이 독립적으로 서비스를 개발, 배포, 확장 할 수 있다.

## 소프트웨어 개발/전달 프로세스

- 지속적 전달의 핵심은 소프트웨어를 언제라도 릴리스 할 수 있는 능력!
- 자동화 테스트 등 높은 수준의 자동화는 필수
